---
title: "Jenkins CI/CD Using Master Slave,Docker, DockerHub, and EC2"
seoTitle: "Jenkins CI/CD with Docker and EC2 Integration"
seoDescription: "Learn how to set up Jenkins CI/CD with Docker, DockerHub, and AWS EC2. Follow steps for infrastructure and pipeline automation"
datePublished: Wed Nov 13 2024 10:26:44 GMT+0000 (Coordinated Universal Time)
cuid: cm3fql3vx000108l58ma98xo5
slug: jenkins-cicd-using-master-slavedocker-dockerhub-and-ec2
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1731492129886/7a47d332-c2f1-43a3-b7af-61b34759757d.webp
tags: jenkins-cicd-continuous-integration-continuous-deployment-devops-automation-pipeline-jenkins-tutorial-jenkins-pipeline-devops-tools

---

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcvvgHl-4iDaK5OiOjZ5jSp-50KxC3IC14VYM68VRjvjrbkzEN9B6NolDZBnnrcyfZt3fNkSQZ7ANs-zDuQbZSMfksuepL0ySKbTodGMdPL6QhHXoKueNkphebw4a6B-89jqKnPWT2e4iLYcZ_YalmwHwa-?key=DnSugcD0aYnLnCt2x0kcng align="left")

#### Prerequisites:

1. AWS account with EC2 instance access.
    
2. Basic knowledge of Jenkins, Docker, and CI/CD principles.
    
3. An active DockerHub account.
    

---

### 1\. Setting Up Jenkins Master Node on EC2

To start, create an EC2 instance for the Jenkins master node:

* Instance type: `t2.large`
    
* Storage: 20 GB
    
* OS: Ubuntu
    

#### Install Jenkins on Ubuntu

Update the server and install necessary packages:

```plaintext
sudo apt update -y
sudo apt install openjdk-17-jre-headless -y
```

Next, add the Jenkins key and repository:

```plaintext
sudo wget -O /usr/share/keyrings/jenkins-keyring.asc https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key
echo "deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/" | sudo tee /etc/apt/sources.list.d/jenkins.list > /dev/null
```

Update again and install Jenkins:

```plaintext
sudo apt-get update
sudo apt-get install jenkins
```

#### Access Jenkins

Copy your instance’s IP address and go to `<Your-IP-Address>:8080` in your browser. Use the initial admin password found in:  
**sudo cat /var/lib/jenkins/secrets/initialAdminPassword**  

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdIi2iI4zNc8QXO_yVdN2bdmv-01Xnpl_2eqgjE29FO3yGlPgh2mH505ztAgAi8B3fHJNVbmLQ75WxZjcTtNNXvcpCEmSj4x5hiE90tkqhIRVFMWoxSFV5DA3-q3_5IbD0SjwrRkcBbc2pn32hskycQ0CsM?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXf6swi-DAUHhGnJJ-scCngxU2fE2EXGcEr_-fYN0PcRDYt1Sgq_yyVbFRGOU-MPcmU2ymZeDUVkX4WxH73e7PVnaCHnJC2Xw5PYGrVRnFuh8Q0vK0A78-l0YcjPHzBdNMkwEKtRcefhSohmjRxD59UyMkY?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdFrprpYmIm90e8D5NaYHk4bNy-V-BJ55izm-FxdQHRYe0VVcb17K6GK0PGovHbhYrhXg7HOx_3aFRubyhPw4XXNczWD4nfndtJqBSEqA7nav66qeeGAJjHN3Yb8g8ezfCkt_rhOmEXB0ZM6f9KlTgVxrI3?key=DnSugcD0aYnLnCt2x0kcng align="left")

---

### 2\. Setting Up Jenkins Slave Node on EC2

Create another EC2 instance to act as a Jenkins agent (slave node):

* Instance type: `t2.micro`
    
* Storage: 8 GB
    
* OS: Ubuntu
    

#### Install JDK and Docker on the Slave Node

```plaintext
sudo apt install openjdk-17-jdk docker.io -y
sudo usermod -aG docker $USER
```

Install Docker Compose:

```plaintext
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXeFfJEvDi7yClt59W_1r43qKMlEUtKMv8YYSe5MhFpha7uV_Nu7ejA7rduqd4AJzVezD_Pp7KYk5BFwLr29VDnl1v_8R9NW7P0SGizW9klcK0-xf-_tI2TK8DjAuHcoUZh1DMcawfcqbg4g02YliHnLT9Q?key=DnSugcD0aYnLnCt2x0kcng align="left")

---

### 3\. Connecting Slave Node to Jenkins Master

#### Step 1: Add Slave Node in Jenkins

In Jenkins UI:

1. Go to **Manage Jenkins &gt; Manage Nodes and Clouds &gt; New Node**.  
    
    ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXe-MCePl3OLJK1L7QXyxDrHT10yTT8y0Ifr0ujUoSww2Z7GChQurqmWhIkTldsB_BZd3kRjzzyNbIDhqtuccxR72Isy_pMPDOxr3YzMvMB70az3LX9qJRnMxnPNkYsD5lD_qhMKgjlxbXzBBiMnh_ihNGXH?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
2. ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXeNcruufdIa7Do1vQyHgY1rUfpM_iqWE9ksAg5MyxLYOy0nrssBgotTonKc1nkTPOWtUPZWYwe_rOHcvTuTY67k3EcATu1_BRVMJR836zqg0qUzSEN1SvEbqLphxsrZpW4kg95bhjChJ5DqwCSZoJVluQ6b?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
    Name it `jenkins-slave` and provide the public IP of your slave instance.  
    

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdTyI72QFv_HhGkviPJ7ddCX17FuQ4oAPsQHtxuYERAny25e8vjP-a8azNXVoCF9K2la79yhfakVwN6XjjKEWOkHLms5OuNqW4ZOe06ClxZhHpWfLwZ9yXV9-rE5TElDu2JPkVaAUkGZLEtMM068y_t9HKs?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXc4hZ1zUb9RUZJGnmwzvTytuu_cKh_pxexB_mIUWUGNLNXvVw4uurWBfClMhYK84DD_s51R4qaq3hdz4-NcBd-KNkjmt7Nx44Re9V-tiZ8L8UjjCfoxQu57rt304zmU7qjExH59WCvDt8iHIPpyM-SqCOg9?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcoxzG2zzrv1P7ldviIZ0l-CtHTi6CMiPrGGAvi-hxH6be8yvwF3kvWakWgpLzE054ZWVEuVjsKy3Iw6_Wuq2eMtBD5PaX5xqvcWBfVBFjoHs1eqTY5ceeIqFasRQmcBlw3JeCNFRw-Izr9NEaHavjFu8sM?key=DnSugcD0aYnLnCt2x0kcng align="left")

For host put public ip of jenkins slave server

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXeiKCGqeY-7pveoU1Z_wWlCxIDSk6C5HBDVLBxM8on9hvYbvTQs4NX7uE1nME5L8w_K1p4REB0E3KmG3ApjwWpu00RzfpV88DFXH3a0CdbGqQ3V0oqI6FCcPgJPjtCbmxY3AwFwWOuzfya9NWVTQ1oui2k?key=DnSugcD0aYnLnCt2x0kcng align="left")

#### Step 2: Set Up SSH Authentication

####   
Now for credentials create keys using  ssh-keygen on master node  
This will create one private and public key but to connect master node with slave we need private key of master node as a credentials to connect with slave  
  
Copy private key of master node 

#### Use the private key as credentials in Jenkins and copy the public key to the `~/.ssh/authorized_keys` file on the slave instance. This will allow Jenkins master to communicate with the slave.

On the master node, create SSH keys:

```plaintext
ssh-keygen -t rsa -b 2048
```

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcMAppvOQJGQqs5lLcpM-Ja9uq7YATruN-dmFMZw6YMKv4meWK7Fz9kIqVnqthLWoRY03LjY-s_UlRYbaQedI0kDynd79l6WakWKq1-wmCGRkaQ5mxxFOGENy0iCMgG3pCuRbqKavA8BxU8oe7qVQowFeM?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcF5Au9rqny1GnohCtQo1Rrz4iWObkVMrSE23UCqDrXqCbPPRjMRCPfV8CmMOdv8aKOXiav17OskAb91SgXABE1qkt9y1XtjZrdR8lFo6OqHD25-zhSO71mkLFRnu9Ik7wdgeLB-om9yLwzMyfkvd-Zn554?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXd48E3UsAcaIB7snhTIN_oT1GINnv5bBLKjsMAWpMaHlszP3_y0Rq0ORfDbl1OMZ2C1Ww1gZ071EMM_HuNaO0NRZgq7gsAQ2cjWYKLG4p1MiNxNJWEKKSud-sClRW65zgxEcLc33RqPAw_xfyFCJq-LBdoG?key=DnSugcD0aYnLnCt2x0kcng align="left")

Select credential that we created and setup slave node

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcSQZHHShG93NxXsEAa5kd14LnXRlhQEQyYVUIg6KFiYt8TqrRLmfcClJ4sFBHrViunTBHzwSjoMkmmq-EcL0_ERhPRMUa_WOnBoAx3_6ACu1zhCIJ9XHHTyrwJ_DDHiALOvhzPYmIKPeOfm_dz-VVLZAlv?key=DnSugcD0aYnLnCt2x0kcng align="left")

Now copy the public key from the master node and paste it into the authorized file of the slave agent.

Go to the slave machine.

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXekSgPMVBPfxREDjkvRB7N14rETnWsgGDfH-N7dlFDVKfcxB-WfWZJ4SlnejWXY93pLpuzX66TDNm8eHaaLrCzPnczwpu_PSeIZfqkRsFg6p0ZjkI71Ai7qzvYsQUZAgU7Im_PHMET9kL1iGdxAiVjJxW5m?key=DnSugcD0aYnLnCt2x0kcng align="left")

Paste the public key from the Jenkins master.

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdBbCFq32FNZOiZAj47XKhzqpWqdvvlpeJrKUi9TaaIAaY6bls_xSojinyVVXJ9BBNkPJhzK8QbjgJlUbdg6iNaVl5aXv8ClC3-r9qQJYtntcXahJ-A9LuOcX5wAjxJ2xrPDFBODXOBRwvMI9wqO29LXYgI?key=DnSugcD0aYnLnCt2x0kcng align="left")

Launch agent we can see node is connected now

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXftyjqVlCdOn3PNKZCT0Ym8ZfOf5Z2pUT2C671qhL0SdNzgQo9psQsaBq6wM-EzHpJ0taWxvl_oLo3S_l5zhWIixATJYyVdhhaPBsn41NIBEzOk7T__WrkB5S97Fn0iBZk0NZMwu0MJo2JXGtiPh_BGFppK?key=DnSugcD0aYnLnCt2x0kcng align="left")

---

### 4\. Setting Up a CI/CD Pipeline  

[**https://github.com/imkiran13/Django-Notes-App.git**](https://github.com/imkiran13/Django-Notes-App.git)

#### [Step 1: Create a New Pipeline Job](https://github.com/imkiran13/Django-Notes-App.git)

[In Jenkins:](https://github.com/imkiran13/Django-Notes-App.git)

1. Go to **New Item &gt; Pipeline** and name it `Django-app`.
    
2. ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXdgWvO3_DbbklWh5qAyuUd8l_arrdF3fXEn198IfFP-j7FE-DtX3lrK9o1EV92UqRwCDeFTP6s081pI2n9Uqb5wwzMZK3sJC6ZSVy8yes0FyWvbTYO8h5cjCuLKS6B7ON3EmxyO-YO5N4OwJQ-aUGOJbL_c?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
3. ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXd3m-d-7fawbBmDtm9l1wnM7Myix_WStRqUk94PaicA0BDUNa4AG0svk3F3wlpcPqznOwuC6Ikk0aKMtuP6My4hMD1eiIg_qUpH3LPbiyz5W5b-PpE9orMejpv7P-fo7VNg4AxjLTSTBSu_zdAt-zUpXjy0?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
    Save and run the pipeline to view it in steps. We need to install a plugin called Pipeline Stage View.
    
    ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXcx0f0vGcOR0sQQfvkInXciCm2-T02VvaXhIk8HD3LJ5BpU1gIMRNq9-ZNo6gTpH--sURR6ESSMwwzNU0lVOGz-cf8GdvI2I_1KYcQ23skx2R7xkC4IywRqDoMqWGt6VAGUdewkiYwDZDjnNHEYmo-xCHal?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
4. Check pipeline stages you can see view
    
    ![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXfgoxnqXT9Gac019erJ6hkAc4H3xleQsNiBbf37Dr2qYU_BtNbTU08wXiN6xGzfRcFs5rVfFJOr3BCBXJl-gYWyiJxf8DRv2qsIopgMPKW9ITzoRrQMcNrNlN12argqJUM1eHJOpeuNwqmrMEZ8PIElC5E?key=DnSugcD0aYnLnCt2x0kcng align="left")
    
5. Use the following declarative pipeline code to automate the CI/CD:
    

```plaintext
pipeline {
    agent { label "jenkins-slave" }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', url: 'https://github.com/imkiran13/Django-Notes-App.git'
            }
        }
        stage('Docker Build') {
            steps {
                sh 'docker build -t notes-app:latest .'
            }
        }
        stage('Push to DockerHub') {
            steps {
                withCredentials([usernamePassword(credentialsId: 'dockerHub', passwordVariable: 'dockerHubPass', usernameVariable: 'dockerHubUser')]) {
                    sh 'docker login -u $dockerHubUser -p $dockerHubPass'
                    sh 'docker tag notes-app:latest $dockerHubUser/notes-app:latest'
                    sh 'docker push $dockerHubUser/notes-app:latest'
                }
            }
        }
        stage('Docker Deploy') {
            steps {
                sh 'docker run -d -p 8000:8000 notes-app:latest'
            }
        }
    }
}
```

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXffjH2KXCjh3V3DUqCxoiDAsyuuYDrOiGepKw6higkNMdYZXjaafbqDMV96bAh1zZ7ZoFWn7rHKvTRHH07OXRXqZqIVewKcJcAbjadp2YOCm7LaopRZ9jfacldhz-B8bDF5dd0Q2QzAZYbl-FPMbqYqW9c?key=DnSugcD0aYnLnCt2x0kcng align="left")

![](https://lh7-rt.googleusercontent.com/docsz/AD_4nXeBqkeAR1S7PdMi3d2yoku5UKHE3J_qxH5M5nvH52ypVMNaWjnMy801u2aDR5B60gnkYzSYLaT2GXwTg8iITxPFjiYVOxqHdJNxRg7sAQQ_ykaTuLUSdEqQOZHE7BuxdVDQV7XBTol_nQ2RLzANJeJGKyA?key=DnSugcD0aYnLnCt2x0kcng align="left")

#### Step 2: Enable Webhook Triggers

Enable **GitHub webhooks** to auto-trigger the pipeline when changes are pushed to the repository:

1. Go to **Project &gt; Configure &gt; Build Triggers** and enable **GitHub hook trigger for GITScm polling**.
    
2. Set up a webhook in your GitHub repository pointing to your Jenkins server.
    

---

### 5\. Using Shared Libraries

To improve reusability and modularity, we’ll use a shared library for pipeline functions.

1. Create a shared library repository and add functions like `code_checkout`, `docker_build`, and `docker_push`.
    
2. Configure the shared library in **Manage Jenkins &gt; Global Pipeline Libraries**.
    

In your pipeline, reference the library:

```plaintext
@Library("Shared") _
pipeline {
    agent { label "jenkins-slave" }

    stages {
        stage("Checkout") {
            steps {
                script {
                    code_checkout("https://github.com/imkiran13/Django-Notes-App.git", "main")
                }
            }
        }
        stage("Build") {
            steps {
                script {
                    docker_build("notes-app", "latest", "imkiran13")
                }
            }
        }
        stage("Push to DockerHub") {
            steps {
                script {
                    docker_push("notes-app", "latest", "imkiran13")
                }
            }
        }
        stage("Deploy") {
            steps {
                sh "docker-compose down && docker-compose up -d"
            }
        }
    }
}
```

---

### 6\. User Management in Jenkins (Role-Based Access)

For better security and organization, set up user roles.

1. Install the **Role-based Authorization Strategy** plugin.
    
2. Go to **Manage Jenkins &gt; Configure Global Security**.
    
3. Assign specific roles and permissions to users. For instance, create a user `ram` with limited permissions.
    

---

### Conclusion

This Jenkins CI/CD pipeline using Docker and DockerHub provides an efficient and scalable setup for deploying applications. With Jenkins agents, shared libraries, and secure role management, your CI/CD system is flexible and robust, ready for complex production environments.